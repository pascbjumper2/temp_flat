<div class="maindiv">

  <p class="bigtitle">Order your flat-jack<sup>&#174;</sup></p>
  <hr />

  <div class="container-fluid">
    <div class="row-fluid">



      <% @products.each do |g| %>


      <div class="col-sm-6 col-md-3 sized" style="margin:30px;">
        <div class="pick">
          <p class="centeredImage"><img src="<%= g.image.url %>"/></p><br />
          <p class="centered bold"><%= g.name %><sup>&#174;</sup></p>
          <p class="centered"><%= g.description.html_safe %></p>
          <div class="bottomedout"><div class="centered"><a class="btn btn-warning" onclick="append_checkout(<%= g.price/100.00 %>, <%= g.shipping/100.00 %>, <%= g.id %>, '<%= g.name %>')" target="_blank">Add to Cart</a></div></div><!--Activate function with price, shipping price, and name-->
          <p class="centered"><%= number_to_currency(g.price/100.00) %></p>
        </div>
      </div>
      <% end %>

    </div>
  </div>
</div>




<script>
    var total = 0;
    var array_ref = 0;

    var checkout_array = [];



    $( document ).ready(function() {
        $( "#checkout" ).hide( );
    });


    //Adds new products to checkout cart
    function append_checkout(price, shipping, product_id, name){
        $( "#checkout" ).fadeIn(  );
        //alert("$" + price + " $" + shipping + product_id + name);
        $( ".table  tbody" ).append( "<tr><td>" + name + "</td><td> $" + price + " + $" + shipping + " (Shipping)</td><td><a class='glyphicon glyphicon-remove pull-right' onclick='remove_ref(this, " + array_ref + ")' style='padding-right: 60px;'></a></td></tr>" );
        array_ref++;
        total = total + price + shipping;
        checkout_array.push(product_id);
        $("#total").text("Total: $" + total);
        $(".submit_to").val(checkout_array);
        alert(price + " and " + shipping);
    }

    //Removes from cart by changing product_id in array to 0, and removing visible entry
    function remove_ref(id, ref) {
        $(id).parent().parent().remove();
        checkout_array.splice(ref, 1, 0);
        $(".submit_to").val(checkout_array);
        total = total - price - shipping;
        $("#total").text("Total: $" + total);
    }


</script>




<div id="checkout" class="container" style="margin-bottom: 50px;">
    <div class="row">
        <div class="panel panel-default">
          <div class="panel-heading" style="height:50px;"><h5 class="panel-title pull-left" style="padding-top:7px;"><span class="glyphicon glyphicon-shopping-cart"></span> Shopping Cart</h5><button class="btn btn-info pull-right" style="margin-top:-2px;">Checkout</button></div>
          <table class="table">

                <tr>
                  <td class="col-md-4"><b>Item</b></td>
                  <td class="col-md-4"><b>Price</b></td>
                  <td class="col-md-4"></td>
                </tr>

          </table>
          <div class="panel-footer"><b id="total">Total:</b></div>
        </div>
    </div>
</div>




<%= form_tag("/visitors/receive", method: :post) do %>
    <%#= hidden_field 'swag', :class => 'submit_to', value: 'posted_array' %>
    <input name="posted_array" class="submit_to" value="cellphone" type="hidden">
    <%= submit_tag("Submit") %>
<% end %>





<div class="modal fade bs-example-modal-lg" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Camper edition flat-jack<sup>&#174;</sup></h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-6">
            <p>The well known process on a camp site:  supporting, jacking-up, stabilizing. The question for a leveling wedge: using a full automatic or manual support? We have a solution for our camper fans: the flat-jack® camper edition. Made with our reliable PU/PUR membrane, this edition was designed with all of the necessities for a camper in mind.</p>
            <p><ul>
            <li>Maximum load: verified up to 2.5 tons per wheel</li>
            <li>Perfect for tire widths up to 255mm</li>
            <li>Operating pressure 0.8 – 1.3 bar/8.7 to 18.85 psi</li>
            <li>Maximum pressure: 1.5 bar/ 21.75 psi</li>
            <li>High quality valve</li>
            <li>Extremely light and space saving</li>
            <li>Tire protection and tension reduction in the chassis</li>
            <li>Equipped with a special inner construction for camper vehicles (double-walled high frequency welded)</li>
            <li>Can be used as leveling system on uneven ground (1 flat-jack®camper up to 6 cm, 2 flat-jack® camper air-pillows piled up to 12 cm)</li>
          </ul></p>
          </div>
          <div class="col-md-6">
            <img src="img/flatjack30.jpg" width="350px"/>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <a class="btn btn-warning" href="#" target="_blank">Add to Cart</a>
      </div>
    </div>
  </div>
</div>